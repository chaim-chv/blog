<!DOCTYPE html>
<html lang="he">
<head>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <title>רשימת תפוצה באנשי קשר של גוגל</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" type="text/css" href="/assets/built/fonts.css?v=ac34f1bcc3" />
    
    <script src="/assets/built/shabbos.js?v=ac34f1bcc3"></script>

    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css?v=ac34f1bcc3" />
    <link rel="stylesheet" type="text/css" href="/assets/built/rtl.css?v=ac34f1bcc3" />
    <link rel="stylesheet" type="text/css" href="/assets/built/prism.css?v=ac34f1bcc3" />
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    
    <meta name="description" content="שימוש מעניין בפלטפורמת גוגל סקריפט על מנת לאסוף כתובות אימייל ממשתמשים - לאנשי קשר של גוגל &gt;&gt;&gt;" />
    <link rel="icon" href="https://blog.chv.ovh/content/images/size/w256h256/2022/02/portait-rounded-256x256px.png" type="image/png" />
    <link rel="canonical" href="https://blog.chv.ovh/mailing-list-gas/" />
    <meta name="referrer" content="no-referrer-when-downgrade" />
    <link rel="amphtml" href="https://blog.chv.ovh/mailing-list-gas/amp/" />
    
    <meta property="og:site_name" content="CHV&#x27;s blog" />
    <meta property="og:type" content="article" />
    <meta property="og:title" content="רשימת תפוצה באנשי קשר של גוגל" />
    <meta property="og:description" content="שימוש מעניין בפלטפורמת גוגל סקריפט על מנת לאסוף כתובות אימייל ממשתמשים - לאנשי קשר של גוגל &gt;&gt;&gt;" />
    <meta property="og:url" content="https://blog.chv.ovh/mailing-list-gas/" />
    <meta property="og:image" content="https://res-5.cloudinary.com/hxitlswav/image/upload/q_auto/v1/ghost-blog-images/contacts.png" />
    <meta property="article:published_time" content="2021-02-09T14:32:59.000Z" />
    <meta property="article:modified_time" content="2021-02-12T11:16:59.000Z" />
    <meta property="article:tag" content="google scripts" />
    
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="רשימת תפוצה באנשי קשר של גוגל" />
    <meta name="twitter:description" content="שימוש מעניין בפלטפורמת גוגל סקריפט על מנת לאסוף כתובות אימייל ממשתמשים - לאנשי קשר של גוגל &gt;&gt;&gt;" />
    <meta name="twitter:url" content="https://blog.chv.ovh/mailing-list-gas/" />
    <meta name="twitter:image" content="https://res-5.cloudinary.com/hxitlswav/image/upload/q_auto/v1/ghost-blog-images/contacts.png" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="chv" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="google scripts" />
    <meta property="og:image:width" content="1920" />
    <meta property="og:image:height" content="1075" />
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Article",
    "publisher": {
        "@type": "Organization",
        "name": "CHV&#x27;s blog",
        "url": "https://blog.chv.ovh/",
        "logo": {
            "@type": "ImageObject",
            "url": "https://blog.chv.ovh/content/images/size/w256h256/2022/02/portait-rounded-256x256px.png"
        }
    },
    "author": {
        "@type": "Person",
        "name": "chv",
        "image": {
            "@type": "ImageObject",
            "url": "https://www.gravatar.com/avatar/df01aec34c54df6fff2e1a61febee17d?s=250&r=x&d=mp",
            "width": 250,
            "height": 250
        },
        "url": "https://blog.chv.ovh/author/chv/",
        "sameAs": []
    },
    "headline": "רשימת תפוצה באנשי קשר של גוגל",
    "url": "https://blog.chv.ovh/mailing-list-gas/",
    "datePublished": "2021-02-09T14:32:59.000Z",
    "dateModified": "2021-02-12T11:16:59.000Z",
    "image": {
        "@type": "ImageObject",
        "url": "https://res-5.cloudinary.com/hxitlswav/image/upload/q_auto/v1/ghost-blog-images/contacts.png",
        "width": 1920,
        "height": 1075
    },
    "keywords": "google scripts",
    "description": "שימוש מעניין בפלטפורמת גוגל סקריפט על מנת לאסוף כתובות אימייל ממשתמשים - לאנשי קשר של גוגל &gt;&gt;&gt;",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "https://blog.chv.ovh/"
    }
}
    </script>

    <meta name="generator" content="Ghost 5.18" />
    <link rel="alternate" type="application/rss+xml" title="CHV&#x27;s blog" href="https://blog.chv.ovh/rss/" />
    <script defer src="https://cdn.jsdelivr.net/ghost/portal@~2.14/umd/portal.min.js" data-ghost="https://blog.chv.ovh/" data-key="ff6c3adb86a27871ef669442ae" data-api="https://blog.chv.ovh/ghost/api/content/" crossorigin="anonymous"></script><style id="gh-members-styles">.gh-post-upgrade-cta-content,
.gh-post-upgrade-cta {
    display: flex;
    flex-direction: column;
    align-items: center;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
    text-align: center;
    width: 100%;
    color: #ffffff;
    font-size: 16px;
}

.gh-post-upgrade-cta-content {
    border-radius: 8px;
    padding: 40px 4vw;
}

.gh-post-upgrade-cta h2 {
    color: #ffffff;
    font-size: 28px;
    letter-spacing: -0.2px;
    margin: 0;
    padding: 0;
}

.gh-post-upgrade-cta p {
    margin: 20px 0 0;
    padding: 0;
}

.gh-post-upgrade-cta small {
    font-size: 16px;
    letter-spacing: -0.2px;
}

.gh-post-upgrade-cta a {
    color: #ffffff;
    cursor: pointer;
    font-weight: 500;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a:hover {
    color: #ffffff;
    opacity: 0.8;
    box-shadow: none;
    text-decoration: underline;
}

.gh-post-upgrade-cta a.gh-btn {
    display: block;
    background: #ffffff;
    text-decoration: none;
    margin: 28px 0 0;
    padding: 8px 18px;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 600;
}

.gh-post-upgrade-cta a.gh-btn:hover {
    opacity: 0.92;
}</style>
    <script defer src="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/sodo-search.min.js" data-key="ff6c3adb86a27871ef669442ae" data-styles="https://cdn.jsdelivr.net/ghost/sodo-search@~1.1/umd/main.css" data-sodo-search="https://blog.chv.ovh/" crossorigin="anonymous"></script>
    <script defer src="/public/cards.min.js?v=ac34f1bcc3"></script>
    <link rel="stylesheet" type="text/css" href="/public/cards.min.css?v=ac34f1bcc3">
    <script defer src="/public/member-attribution.min.js?v=ac34f1bcc3"></script>
    <!-- self-hosted umami analytics - privacy focused -->
<script async defer data-website-id="975eb99f-8334-434c-b6b5-e8aa9e6e1003" src="https://umami.chv.ovh/umami.js"></script><style>:root {--ghost-accent-color: #15171A;}</style>

    <meta name="google-site-verification" content="idgrb37VmvOFTqk3oRpi-LGYR05-7VNsWgeoc3ODs3Y" />
    
    <script src="https://onesignal.chv.ovh/sdks/OneSignalSDK.js"></script>
    <script>
        window.OneSignal = window.OneSignal || [];
            OneSignal.push(function () {
                OneSignal.init({
                    appId: "74c8b239-c6ab-4d8a-a54e-c0ba8fe5b57e",
                    notifyButton: {
                        enable: false,
                    },
                    welcomeNotification: {
                        "title": "ברוך הבא",
                        "message": "נרשמת בהצלחה"
                    }
                });
            });
    </script>

</head>
<body class="post-template tag-google-scripts">

    <script>
    function onManageWebPushSubscriptionButtonClicked(event) {
        getSubscriptionState().then(function(state) {
            if (state.isPushEnabled) {
                /* Subscribed, opt them out */
                OneSignal.setSubscription(false);
            } else {
                if (state.isOptedOut) {
                    /* Opted out, opt them back in */
                    OneSignal.setSubscription(true);
                } else {
                    /* Unsubscribed, subscribe them */
                    OneSignal.registerForPushNotifications();
                }
            }
        });
    }

    function updateMangeWebPushSubscriptionButton() {
        var hideWhenSubscribed = false;
        var subscribeText = "הירשם להתראות בדפדפן על פוסטים חדשים";
        var unsubscribeText = "התנתק מההתראות";

        getSubscriptionState().then(function(state) {
            var buttonText = !state.isPushEnabled || state.isOptedOut ? subscribeText : unsubscribeText;

            var top = document.querySelector(topbutton);
            if (top === null) {
                return;
            }
            var bottom = document.querySelector(bottombutton);
            if (bottom === null) {
                return;
            }

            top.textContent = buttonText;
            bottom.textContent = buttonText;
        });
    }

    function getSubscriptionState() {
        return Promise.all([
          OneSignal.isPushNotificationsEnabled(),
          OneSignal.isOptedOut()
        ]).then(function(result) {
            var isPushEnabled = result[0];
            var isOptedOut = result[1];

            return {
                isPushEnabled: isPushEnabled,
                isOptedOut: isOptedOut
            };
        });
    }

    var OneSignal = OneSignal || [];
    var topbutton = "#notify-top";
    var bottombutton = "#notify-down"

    /* This example assumes you've already initialized OneSignal */
    OneSignal.push(function() {
        // If we're on an unsupported browser, do nothing
        if (!OneSignal.isPushNotificationsSupported()) {
            return;
        }
        updateMangeWebPushSubscriptionButton(topbutton);
        updateMangeWebPushSubscriptionButton(bottombutton);
        OneSignal.on("subscriptionChange", function(isSubscribed) {
            /* If the user's subscription state changes during the page's session, update the button text */
            updateMangeWebPushSubscriptionButton(topbutton);
            updateMangeWebPushSubscriptionButton(bottombutton);
        });
    });
    updateMangeWebPushSubscriptionButton(topbutton);
    updateMangeWebPushSubscriptionButton(bottombutton);

    function track(description, type, url) { if (typeof umami !== "undefined") { umami.trackEvent(description, type, url || window.location.href ) } }
    </script>

    <div class="site-wrapper">

        

<header class="site-header">
    <div class="outer site-nav-main">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left-wrapper">
        <div class="site-nav-left">
                <a class="site-nav-logo" href="https://blog.chv.ovh">CHV&#x27;s blog</a>
            <div class="site-nav-content">
                    <ul class="nav">
    <li class="nav-byt"><a href="https://blog.chv.ovh/">בית</a></li>
    <li class="nav-tsvr-qshr"><a href="https://blog.chv.ovh/contact/">צור קשר</a></li>
</ul>

                    <span class="nav-post-title dash">רשימת תפוצה מגוגל סקריפט - לאנשי קשר של גוגל</span>
            </div>
        </div>
    </div>
    <div class="site-nav-right">
            <div class="social-links">
            </div>

            <div class="notif"><a href="#notify" onclick="onManageWebPushSubscriptionButtonClicked('click')" class="notify-button" id="notify-top">התראות דפדפן</a>
            <span class="notify-button-tooltip">&zwnj; &zwnj; &zwnj; &zwnj; אפשר להירשם לעדכונים על ידי התראות דפדפן ('פושים' push) &zwnj; &zwnj; &zwnj; &zwnj;</span></div>
            <a class="subscribe-button" href="#subscribe">עדכונים ב-<i class="fa fa-envelope" aria-hidden="true"></i> או <i class="fa fa-telegram" aria-hidden="true"></i></a>

    </div>
</nav>
    </div>
</div>    <link rel="stylesheet" type="text/css" href="/assets/built/scroll.css?v=ac34f1bcc3" />
</header>


<main id="site-main" class="site-main outer">
    <div class="inner">

        <article class="post-full post tag-google-scripts ">

            <header class="post-full-header">

                <section class="post-full-tags">
                    <a href="/tag/google-scripts/">google scripts</a>
                </section>

                <h1 class="post-full-title">רשימת תפוצה מגוגל סקריפט - לאנשי קשר של גוגל</h1>

                <p class="post-full-custom-excerpt">שימוש מעניין בפלטפורמת גוגל סקריפט על מנת לאסוף כתובות אימייל ממשתמשים - לאנשי קשר של גוגל &gt;&gt;&gt;</p>

                <div class="post-full-byline">

                    <section class="post-full-byline-content">

                        <ul class="author-list">
                            <li class="author-list-item">

                                <div class="author-card">
                                    <img class="author-profile-image" src="https://www.gravatar.com/avatar/df01aec34c54df6fff2e1a61febee17d?s&#x3D;250&amp;r&#x3D;x&amp;d&#x3D;mp" alt="chv" />
                                    <div class="author-info">
                                        <h2>chv</h2>
                                        <p> קרא <a href="/author/chv/">עוד פוסטים</a> מהכותב הזה </p>
                                    </div>
                                </div>

                                <a href="/author/chv/" class="author-avatar">
                                    <img class="author-profile-image" src="https://www.gravatar.com/avatar/df01aec34c54df6fff2e1a61febee17d?s&#x3D;250&amp;r&#x3D;x&amp;d&#x3D;mp" alt="chv" />
                                </a>

                            </li>
                        </ul>

                        <section class="post-full-byline-meta">
                            <h4 class="author-name"><a href="/author/chv/">chv</a></h4>
                            <div class="byline-meta-content">
                                <time class="byline-meta-date" datetime="2021-02-09">9 פבר׳ 2021</time>
                                <span class="byline-reading-time"><span class="bull">&bull;</span> 2 min read</span>
                            </div>
                        </section>

                    </section>


                </div>
            </header>

            <figure class="post-full-image">
                <img
                    srcset="https://res-5.cloudinary.com/hxitlswav/image/upload/q_auto/v1/ghost-blog-images/contacts.png 300w,
                            https://res-5.cloudinary.com/hxitlswav/image/upload/q_auto/v1/ghost-blog-images/contacts.png 600w,
                            https://res-5.cloudinary.com/hxitlswav/image/upload/q_auto/v1/ghost-blog-images/contacts.png 1000w,
                            https://res-5.cloudinary.com/hxitlswav/image/upload/q_auto/v1/ghost-blog-images/contacts.png 2000w"
                    sizes="(max-width: 800px) 400px,
                        (max-width: 1170px) 1170px,
                            2000px"
                    src="https://res-5.cloudinary.com/hxitlswav/image/upload/q_auto/v1/ghost-blog-images/contacts.png"
                    alt="רשימת תפוצה מגוגל סקריפט - לאנשי קשר של גוגל"
                />
            </figure>

            <section class="post-full-content">
                <div class="post-content">
                    <p>אתמול פשוט נתקלתי באמצע שיטוט בגוגל במילים <code>ContactsApp</code>, ואז נצנץ לי הרעיון פשוט להשתמש באנשי הקשר של גוגל כדי לשמור רשימת תפוצה של מיילים (אני מדבר על הבלוג הזה).</p><p>במקום להתפזר על פני כלים (כגון לשמור את הרשימה דרך ghost - הפלטפורמת בלוגים הנוכחית, או דרך mailchimp וכדו') אפשר לשמור את כל אנשי הקשר הרצויים באנשי קשר גוגל, להקצות להם תווית על מנת לסנן אותם בקלות משאר אנשי הקשר, וזהו. וכל זה על ידי סקריפט פשוט, 'ללא מגע יד אדם'..</p><p>המעלה העיקרית בזה היא שברגע שיש לי רשימה כזו באנשי הקשר - אני כבר מבצע את שליחת הניוזלטרים דרך ג'ימייל (דרך גוגל סקריפט, כדי לבצע bulk messaging. או למתנסחים - merge mail) לכל הכתובות שבתווית המסוימת הזו ברגע אחד (רק צריך לזכור את ההגבלה של גוגל עד 150 הודעות יוצאות ביום מהסקריפט).</p><p>חשבתי איך לקבל את הנתונים מהמשתמש - והחלטתי ללכת פשוט על <code>doGet</code> - שזה בעצם מה שאחראי על תפקוד הסקריפט כ-web app - אפליקציית ווב. ההבדל הבסיסי בין סקריפט רגיל שנמצא אצלי בספריית הסקריפטים לבין סקריפט שנפרס כ-web app - הוא שעם web app ניתן להתממשק (גם אנשים אחרים ולא רק אני) ולהתממסר איתו בפרוטוקול http ממש כמו אתר אינטרנט.</p><blockquote>כשפורסים גוגל סקריפט ל-web app - מקבלים כתובת יחודית לאפליקציית הווב שנוצרה. הפונקציה <code>doGet</code> מגדירה את האירועים שהסקריפט יבצע במקרה של גישה ישירה (GET) לכתובת הסקריפט.</blockquote><p>זה הקוד שבו אני משתמש בגוגל סקריפט'ס, הסבר לאחר מכן:</p><pre><code class="language-javascript">function doGet(e) {
  let email = e.parameters.email
  let name = e.parameters.name
  let method = e.parameters.method
  const validate = validateemail(email)
  if (validate === false) {
    Logger.log(`fake mail submitted...`)
    let result = { email: false, existed: false, created: false }
    return ContentService.createTextOutput(JSON.stringify(result)).setMimeType(ContentService.MimeType.JAVASCRIPT)
  }
  if (method == 'remove') {
    let contact = ContactsApp.getContact(email)
    if (!contact) {
      let result = { removed: false }
      return ContentService.createTextOutput(JSON.stringify(result)).setMimeType(ContentService.MimeType.JAVASCRIPT)
    } else {
      contact.deleteContact()
      Logger.log(`user remove himself from list`)
      let result = { removed: true }
      return ContentService.createTextOutput(JSON.stringify(result)).setMimeType(ContentService.MimeType.JAVASCRIPT)
    } 
  }
  let found = ContactsApp.getContact(email)
  if (!found) {
    Logger.log(`address: ${email}. address not found.. creating contact, naming ${name}`)
    var group = ContactsApp.getContactGroup('בלוג')
    ContactsApp.createContact(name, '', email).addToGroup(group)
    let result = { email: true, existed: false, created: true}
    return ContentService.createTextOutput(JSON.stringify(result)).setMimeType(ContentService.MimeType.JAVASCRIPT)
  } else {
    Logger.log(`address: ${email}. found in contacts, changing to ${name}`)
    found.setFullName(name)
    let result = { email: true, existed: true, created: false}
    return ContentService.createTextOutput(JSON.stringify(result)).setMimeType(ContentService.MimeType.JAVASCRIPT)
  }
}</code></pre><p>את הכתובת וההוראות פעולה אני מקבל מהפרמטרים שנשלחו ב-URL, יש פרמטר של שם (name) של כתובת (email) ושל שיטת הפעולה הדרושה (מחיקה של המייל מהרשימה או הוספה של מייל לרשימה).</p><blockquote>פרמטרים ב-URL זה פשוט לכתוב בסוף הכתובת - סימן שאלה ? ואז פרמטר עם ערך. <strong>לדוגמא</strong> אם שם האתר הוא example.com ואני רוצה לשלוח לו בקשה עם הפרמטר morning=true - פשוט שולחים בקשה לכתובת example.com?morning=true.<br>אם רוצים להכניס כמה פרמטרים יש להפריד ביניהם עם &amp;, ככה:<br>example.com?morning=true&amp;night=false</blockquote><p>לאחר קבלת הפרטים מהבקשה, הסקריפט בודק אם המייל שנשלח הוא אכן כתובת מייל. את זה הוא בודק מול <a href="https://tchumim.com/post/10185">regex</a> שבודק מיילים. זה הפונקציה:</p><pre><code class="language-javascript">function validateemail(email) {
  const emailregex = /^[A-z0-9._%+-]+@[A-z0-9.-]+\.[A-z]{2,}$/
  return emailregex.test(email)
}</code></pre><p>אם הערך ששולחים אליה תואם למבנה החוקי של כתובת מייל - היא מחזירה תשובה <code>true</code>, אחרת - <code>false</code> על פי תנאי זה (במקרה ש-<code>false</code>) הסקריפט עוצר ומחזיר תשובה למבקש עם פירוט בתוך ה-JSON של התשובה - שהמייל מזוייף:</p><pre><code class="language-javascript">if (validate === false) {
    Logger.log(`fake mail submitted...`)
    let result = { email: false, existed: false, created: false }
    return ContentService.createTextOutput(JSON.stringify(result)).setMimeType(ContentService.MimeType.JAVASCRIPT)
  }</code></pre><p>כעת הבדיקה היא אם השיטה (method) היא remove - כלומר שימוש בסקריפט כדי <strong>למחוק </strong>אימייל מרשימת התפוצה -</p><pre><code class="language-javascript">if (method == 'remove') {
    let contact = ContactsApp.getContact(email)
    if (!contact) {
      let result = { removed: false }
      return ContentService.createTextOutput(JSON.stringify(result)).setMimeType(ContentService.MimeType.JAVASCRIPT)
    } else {
      contact.deleteContact()
      Logger.log(`user remove himself from list`)
      let result = { removed: true }
      return ContentService.createTextOutput(JSON.stringify(result)).setMimeType(ContentService.MimeType.JAVASCRIPT)
    } 
  }</code></pre><p>בהתחלה יש בדיקה אם קיים באמת כזה אימייל ברשימה (<code>if (!contact)</code> אם המשתנה של בדיקת האיש קשר ברשימת אנשי הקשר הוא undefined - סימן שאין איש קשר כזה), ואם יש הוא עובר תהליך מחיקה.</p><pre><code class="language-javascript">let found = ContactsApp.getContact(email)
  if (!found) {
    Logger.log(`address: ${email}. address not found.. creating contact, naming ${name}`)
    var group = ContactsApp.getContactGroup('בלוג')
    ContactsApp.createContact(name, '', email).addToGroup(group)
    let result = { email: true, existed: false, created: true}
    return ContentService.createTextOutput(JSON.stringify(result)).setMimeType(ContentService.MimeType.JAVASCRIPT)
  } else {
    Logger.log(`address: ${email}. found in contacts, changing to ${name}`)
    thiss.setFullName(name)
    let result = { email: true, existed: true, created: false}
    return ContentService.createTextOutput(JSON.stringify(result)).setMimeType(ContentService.MimeType.JAVASCRIPT)
  }</code></pre><p>כעת הסקריפט בודק (אם הגיע לכאן, זה רק במקרה שהשיטה שנבחרה בכתובת היא להוסיף כתובת אימייל למאגר) אם לא קיימת כתובת אימייל כמו זו שהוזנה, באנשי הקשר. אם לא קיימת - הוא יוצר איש קשר חדש עם הפרטים שהתקבלו + מחיל עליו את התווית המוגדרת.</p><p>אם המייל נמצא במאגר - מנסה לשנות פשוט את השם כפי שהוזן הפעם.</p><hr><p>כדי לשלב את הסקריפט הזה בצורה פעילה באתר, שילבתי מודל שמבקש מייל + שם, ובלחיצה על כפתור השליחה ('הרשמה') - מוכנס התוכן של תיבות הטקסט (של השם + המייל) לכתובת URL של הסקריפט, עם הפרמטרים המתאימים.</p><p>אפשר להסתכל ב-console של הדפדפן ולראות את התקשורת מול הסקריפט, והתשובות שלו לקריאות.</p><hr><p></p><p>מה שרואים בפוסט הזה זה דבר ראשון - שימוש בסיסי בגוגל סקריפט כ-web app, הפעם באופן של <code>doGet</code>.<br>השימוש בגוגל סקריפט כאפליקציית ווב, מעצים את הפונקציונליות של הסקריפט שלכם ובעצם פותח את הסקריפט להתממשקות מול כל webhook וכל האינטרנט, בעצם.</p><p>זה יכול להיות כלי שימושי ובסיסי בכל תהליך שקשור לאוטומציה באפליקציות ווב (אכתוב כאן בל"נ פוסט איך אני משתמש בזה גם כדי לשלוח התראות מייל בצורה אוטומטית ובקלות. דוגמא אחת).</p><hr><p>קצת מ"מ לפונקציות עיקריות בקוד:</p><ul><li><a href="https://developers.google.com/apps-script/guides/web">הנושא הראשי של web apps בגוגל סקריפט</a></li><li><a href="https://developers.google.com/apps-script/reference/contacts/contacts-app#getcontactemailaddress">ContactsApp.getContact(email)</a></li><li><a href="https://developers.google.com/apps-script/reference/contacts/contacts-app#createcontactgivenname,-familyname,-email">ContactsApp.createContact</a></li><li>באופן כללי, הרבה פונקציות קיימות <strong>על האלמנט איש קשר עצמו</strong>. כלומר כאשר יצרתם משתנה כזה - <code>let contact = ContactsApp.getContact('email')</code> - תוכלו להריץ על <code>contact</code> מניפולציות (כגון <code>contact.setFullName('name')</code> וכדו')</li></ul>
                    <hr class="tg-delete">
                    <p class="tg-delete">
                        <strong>אם יש לכם איזו שאלה ❔✨ או כל תגובה 💬, הארה 💡 והערה ❕ שהיא על הפוסט - אשמח מאוד! אם תכתבו אותה בהערות כאן למטה</strong>
                        <br>
                        פשוט להתחבר עם חשבון גיטהב ולהגיב 🎉
                    </p>
                    
                </div>

                <script src="https://utteranc.es/client.js" 
                  repo="chaim-chv/blog-comments" 
                  issue-term="og:title" 
                  label="✨💬✨comment"
                  theme="github-dark" 
                  crossorigin="anonymous" async>
                </script>

            </section>


            <section class="subscribe-form">

    <h3 class="subscribe-form-title" style="border-bottom: 3px solid green;">הירשם ל-CHV&#x27;s blog</h3>
    <p class="subscribe-form-description">
        <strong style="color: whitesmoke;">🔔 התראות דפדפן 🔔</strong>
        <br>
        אפשר לקבל התראות פוש מהאתר על כל פוסט חדש!
        <br>
        לחץ על הכפתור למעלה או בתחתית העמוד כדי להתחבר
        </p>
        <br><div style="border-top: 3px solid green"></div><br>
        <p class="subscribe-form-description">
        הרשמה לעדכונים במייל על פוסטים חדשים:
        <input style="margin: 10px 0 10px 0;" type="email" class="subscribe-email" id="mailform-down-email" placeholder="myemail@gmail.com" autocomplete="on">
        <input style="margin: 10px 0 10px 0;" type="name" class="subscribe-email" id="mailform-down-name" placeholder="שם (למען הסדר הטוב)" autocomplete="on">
        <button class="button primary" type="button" onclick="subscribe()">
            <span class="button-content">הרשמה</span>
            <span class="button-loader">
                <svg version="1.1" id="loader-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px"
                    y="0px" width="40px" height="40px" viewBox="0 0 40 40" enable-background="new 0 0 40 40" xml:space="preserve">
                    <path opacity="0.2" fill="#000" d="M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946,14.946,14.946
                s14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634
                c0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z" />
                    <path fill="#000" d="M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0
                C22.32,8.481,24.301,9.057,26.013,10.047z">
                        <animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 20 20" to="360 20 20"
                            dur="0.5s" repeatCount="indefinite" />
                    </path>
                </svg>
            </span>
        </button><br>
        <span id="sub-results"></span>
        </p><br><div style="border-top: 3px solid green"></div><br>
        <p class="subscribe-form-description">
        או שתירשמו ל<strong>ערוץ הטלגרם</strong> שגם בו אני אעלה בעז"ה הודעה בכל פוסט חדש כאן<br>
        <strong><a href="https://t.me/chvsblog" target="_blank">לחצו כאן כדי לעבור לערוץ בטלגרם</a></strong>
    </p>

    <script src="/assets/built/subscribe.js?v=ac34f1bcc3"></script>

</section>

        </article>

    </div>
</main>
								
	<div class="progress-wrap">
		<svg class="progress-circle svg-content" width="100%" height="100%" viewBox="-1 -1 102 102">
			<path d="M50,1 a49,49 0 0,1 0,98 a49,49 0 0,1 0,-98"/>
		</svg>
	</div>

<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
                <article class="read-next-card">
                    <header class="read-next-card-header">
                        <h3><span>עוד ב-</span><a href="/tag/google-scripts/">google scripts</a></h3>
                    </header>
                    <div class="read-next-card-content">
                        <ul>
                            <li>
                                <h4><a href="/ghost-webhook-to-newsletter/">אפליקציית NodeJS לאוטומציה של העדכונים בבלוג</a></h4>
                                <div class="read-next-card-meta">
                                    <p><time datetime="2021-03-07">7 מרץ 2021</time> –
                                        2 min read</p>
                                </div>
                            </li>
                            <li>
                                <h4><a href="/gas-bulk-messaging/">שליחת מייל לרשימת תפוצה (bulk messaging) בקלות עם גוגל סקריפט</a></h4>
                                <div class="read-next-card-meta">
                                    <p><time datetime="2021-03-07">7 מרץ 2021</time> –
                                        1 min read</p>
                                </div>
                            </li>
                            <li>
                                <h4><a href="/github-actions-deploy/">הפעלה ידנית של Github actions מתוך גוגל סקריפט</a></h4>
                                <div class="read-next-card-meta">
                                    <p><time datetime="2020-11-03">3 נוב׳ 2020</time> –
                                        2 min read</p>
                                </div>
                            </li>
                        </ul>
                    </div>
                    <footer class="read-next-card-footer">
                        <a href="/tag/google-scripts/">ראה את כל 5 הפוסטים
                            →</a>
                    </footer>
                </article>

                <article class="post-card post tag-google-scripts ">

    <a class="post-card-image-link" href="/gas-bulk-messaging/">
        <img class="post-card-image"
            srcset="https://res-4.cloudinary.com/hxitlswav/image/upload/q_auto/v1/ghost-blog-images/mailing.png 300w,
                    https://res-4.cloudinary.com/hxitlswav/image/upload/q_auto/v1/ghost-blog-images/mailing.png 600w,
                    https://res-4.cloudinary.com/hxitlswav/image/upload/q_auto/v1/ghost-blog-images/mailing.png 1000w,
                    https://res-4.cloudinary.com/hxitlswav/image/upload/q_auto/v1/ghost-blog-images/mailing.png 2000w"
            sizes="(max-width: 1000px) 400px, 700px"
            loading="lazy"
            src="https://res-4.cloudinary.com/hxitlswav/image/upload/q_auto/v1/ghost-blog-images/mailing.png"
            alt="שליחת מייל לרשימת תפוצה (bulk messaging) בקלות עם גוגל סקריפט"
        />
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/gas-bulk-messaging/">

            <header class="post-card-header">
                    <div class="post-card-primary-tag">google scripts</div>
                <h2 class="post-card-title">שליחת מייל לרשימת תפוצה (bulk messaging) בקלות עם גוגל סקריפט</h2>
            </header>

            <section class="post-card-excerpt">
                    <p>שימוש בפלטפורמת גוגל סקריפט כדי לשלוח הודעות מייל מעוצבות ולנמענים רבים בהודעה אחת >>></p>
            </section>

        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
            
                    <div class="author-name-tooltip">
                        chv
                    </div>
            
                    <a href="/author/chv/" class="static-avatar">
                        <img class="author-profile-image" src="https://www.gravatar.com/avatar/df01aec34c54df6fff2e1a61febee17d?s&#x3D;250&amp;r&#x3D;x&amp;d&#x3D;mp" alt="chv" />
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="/author/chv/">chv</a></span>
                <span class="post-card-byline-date"><time datetime="2021-03-07">7 מרץ 2021</time> <span class="bull">&bull;</span> דקה אחת קריאה</span>
            </div>
        </footer>

    </div>

</article>

                <article class="post-card post tag-javascript ">

    <a class="post-card-image-link" href="/js-variables-declaration/">
        <img class="post-card-image"
            srcset="https://res-4.cloudinary.com/hxitlswav/image/upload/q_auto/v1/ghost-blog-images/javascript.jpg 300w,
                    https://res-4.cloudinary.com/hxitlswav/image/upload/q_auto/v1/ghost-blog-images/javascript.jpg 600w,
                    https://res-4.cloudinary.com/hxitlswav/image/upload/q_auto/v1/ghost-blog-images/javascript.jpg 1000w,
                    https://res-4.cloudinary.com/hxitlswav/image/upload/q_auto/v1/ghost-blog-images/javascript.jpg 2000w"
            sizes="(max-width: 1000px) 400px, 700px"
            loading="lazy"
            src="https://res-4.cloudinary.com/hxitlswav/image/upload/q_auto/v1/ghost-blog-images/javascript.jpg"
            alt="מושגים בסיסיים ב-JS: ההבדלים העיקריים בין var, let ו-const"
        />
    </a>

    <div class="post-card-content">

        <a class="post-card-content-link" href="/js-variables-declaration/">

            <header class="post-card-header">
                    <div class="post-card-primary-tag">javascript</div>
                <h2 class="post-card-title">מושגים בסיסיים ב-JS: ההבדלים העיקריים בין var, let ו-const</h2>
            </header>

            <section class="post-card-excerpt">
                    <p>ב-2015 יצא תקן javascript ES6, ובין הדברים שהוא חידש נמצאים let ו-const. מה המטרה שלהם בעצם ומה הם יותר (ופחות) מ-var >>></p>
            </section>

        </a>

        <footer class="post-card-meta">
            <ul class="author-list">
                <li class="author-list-item">
            
                    <div class="author-name-tooltip">
                        chv
                    </div>
            
                    <a href="/author/chv/" class="static-avatar">
                        <img class="author-profile-image" src="https://www.gravatar.com/avatar/df01aec34c54df6fff2e1a61febee17d?s&#x3D;250&amp;r&#x3D;x&amp;d&#x3D;mp" alt="chv" />
                    </a>
                </li>
            </ul>
            <div class="post-card-byline-content">
                <span><a href="/author/chv/">chv</a></span>
                <span class="post-card-byline-date"><time datetime="2021-02-05">5 פבר׳ 2021</time> <span class="bull">&bull;</span> דקה אחת קריאה</span>
            </div>
        </footer>

    </div>

</article>
        </div>
    </div>
</aside>




        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="https://blog.chv.ovh">CHV&#x27;s blog</a> &copy; 2022</section>
                <nav class="site-footer-nav">
                    <a href="https://blog.chv.ovh">פוסטים אחרונים</a>
                    
                    <a href="#notify" onclick="onManageWebPushSubscriptionButtonClicked('click')" id="notify-down">התראות דפדפן</a>
                    <a href="https://ghost.org" target="_blank" rel="noopener">Ghost</a>
                </nav>
            </div>
        </footer>

    </div>

    <div id="subscribe" class="subscribe-overlay">
        <a class="subscribe-close-overlay" href="#"></a>
        <a class="subscribe-close-button" href="#"></a>
        <div class="subscribe-overlay-content">
            <div class="subscribe-form">
                <h1 class="subscribe-overlay-title">הירשם ל-CHV&#x27;s blog</h1>
                <p class="subscribe-overlay-description">
        הרשמה לעדכונים במייל על פוסטים חדשים:
        <input style="margin: 10px 0 10px 0;" type="email" class="subscribe-email subscribe-up-email" id="mailform-up-email" placeholder="myemail@gmail.com" autocomplete="on">
        <input style="margin: 10px 0 10px 0;" type="name" class="subscribe-email subscribe-up-email" id="mailform-up-name" placeholder="שם (למען הסדר הטוב)" autocomplete="on">
        <button class="button primary" type="button" onclick="subscribeup()">
            <span class="button-content">הרשמה</span>
            <span class="button-loader-up">
                <svg version="1.1" id="loader-1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px"
                    y="0px" width="40px" height="40px" viewBox="0 0 40 40" enable-background="new 0 0 40 40" xml:space="preserve">
                    <path opacity="0.2" fill="#000" d="M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946,14.946,14.946
                s14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634
                c0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z" />
                    <path fill="#000" d="M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0
                C22.32,8.481,24.301,9.057,26.013,10.047z">
                        <animateTransform attributeType="xml" attributeName="transform" type="rotate" from="0 20 20" to="360 20 20"
                            dur="0.5s" repeatCount="indefinite" />
                    </path>
                </svg>
            </span>
        </button><br>
        <span id="sub-results-up"></span><br>
        <br>או שתירשמו ל<strong>ערוץ הטלגרם</strong> שגם בו אני אעלה בעז"ה הודעה בכל פוסט חדש כאן<br><strong><a href="https://t.me/chvsblog" target="_blank">לחצו כאן כדי לעבור לערוץ בטלגרם</a></strong></p>
            </div>
        </div>
    </div>

    <script src="/assets/built/subscribe-overlay.js?v=ac34f1bcc3"></script>

    <script src="/assets/built/jquery+members+prism.js?v=ac34f1bcc3"></script>

    <script src="/assets/built/casper.js?v=ac34f1bcc3"></script>

        <script src="/assets/built/postscroll.js?v=ac34f1bcc3"></script>


    <style>
::selection {
  color: black
}
</style>

</body>
</html>
